{% extends "generica.html" %}
{% load static %}
{% block content %}

<div style="padding-left: 2%;padding-right: 1%;width: 100%;height: 100%;">  
<script type="text/javascript">
    var geojson_list = {{ geojson_list|safe }};
    var noteGeojson='{{ noteGeojson}}';
    var noteDraw = null;
    console.log(geojson_list);
    if (noteGeojson!= 'None'){
        noteDraw = JSON.parse('{% autoescape off %}{{ note.geojson_data|escapejs }}{% endautoescape %}');
        console.log(noteDraw);
        console.log(noteGeojson);
    }
    
    var name_slide="{{note.name}}";
    var description_slide="{{note.description}}";
   
    var slideMap = {
        path: "{{projectSlide.slide.path}}",
        zoomI: "{{projectSlide.slide.zoomI}}",
        zoomM: "{{projectSlide.slide.zoomM}}",
        zoomMin: "{{projectSlide.slide.zoomMin}}",
        maxLatLng: "{{projectSlide.slide.maxLatLng}}",
        centerLat: "{{projectSlide.slide.centerLat}}",
        centerLng: "{{projectSlide.slide.centerLng}}",
        factor: "{{projectSlide.slide.factor}}",
        noteDraw: noteDraw,
        noteGeojson: noteGeojson

    };    
</script>
<link rel="stylesheet" href="{% static 'projects/css/note.css' %}">
<script type="text/javascript" src="{% static 'microscope/js/micro.js' %}"></script>
<script type="text/javascript" src="{% static 'projects/js/note.js' %}"></script>
<div id="map" style="position: absolute;background-color:rgb(0, 0, 0);left: 2%;top:8%;z-index:0;width:96%;height: 90%">

    
    <div id="custom-button-container">
        <a id="custom-button" style="padding: 5%;" class="leaflet-draw-draw-polyline material-icons" href="#" title="Guardar cambios">save</a>
    </div>
    <div id="custom-button-container2">
        <input type="color" style="width: 30px;height: 30px;" id="colorPicker" value="#3388ff">
    </div>
</div> 
<div id="menuPrincipal"style = "pointer-events: none;position: absolute; left: 2%;top: 7%;z-index:1; width:22%; height: 93%;">
    <!-- <button class="btn btn-primary js-tooltip" onclick="w3_open()"></button> -->
 
<!-- <div style="position: relative; float: left;left: 2%; top:2%;width: 96%">
    <div style="padding: 1%;box-shadow: 1px 1px 3px rgb(100, 99, 99); z-index:1;border-radius:10px 10px 0 0;background-color:rgb(255, 255, 255);width: 100%">
        <h3 style="text-align: center;">Anotaciones</h3> 
        
    </div>
</div>
<div style="float:left;height:3%;width:100%"></div> -->
<div style="position: relative; float: left;top:2%;left: 2%; width: 96%">
    <div class="elemento" style="padding-top: 2%; border-radius:10px ;z-index:1;background-color:rgba(51, 51, 51, 0.8);width: 100%">
        
     
        
        
            <div class="titulo-y-botones">
                <h4 style="text-align: center;color: #fff;width: 80%;">{{projectSlide.name}}</h4> 
                <div class="botones-opciones">
                    <a href="#" id="abrirModal" class="btn-opcion2 notaNueva"><i class="material-icons">note_add</i></a>
                    <a href="#"  class="btn-opcion2"><i id="botonDesplegar" class="material-icons">expand_less</i></a>
                </div>
            </div> 
                   
               
    </div>
</div>

<div id="miModal" class="modal elemento">
    <div class="modal-contenido">
    <span class="cerrar" id="cerrarModal">&times;</span>
    <h2>Nueva Nota</h2>
    <form method="POST" > 
        {% csrf_token %}
        {{ form.as_p }}
        <!-- Otros campos de formulario... -->
        <input type="hidden" name="option" value=0>
        
        <div style="position: relative; left: 2%;" class="botones">
            <button type="submit" class="boton-enviar btn-primary">crear</button>
            <button type="button" class="boton-cerrar btn-danger " id="cerrarModal2">Cancelar</button>
        </div>
    </form>
    </div>
</div>

<div id="miModal2" class="modal elemento">
    <div class="modal-contenido">
    <span class="cerrar" id="cerrarModal3">&times;</span>
    <h2>Guardar dibujo en {{note.name}}</h2>
    <form method="POST" > 
        {% csrf_token %}
        <!-- Otros campos de formulario... -->
        <input id="geojson_data" type="hidden" name="geojson_data" value="">
        <input type="hidden" name="option" value="1">
        <input type="hidden" name="pos11" value="1">
        <input type="hidden" name="pos12" value="1">
        <input type="hidden" name="pos21" value="1">
        <input type="hidden" name="pos22" value="1">
        Texto:
        <input style="border: 1px solid #ccc;border-radius: 4px;width: 100%" id="name" type="text" name="name" value="{{note.name}}">
        <div style="position: relative;height:25px;width:100%"></div>
        Detalles de la nota:
        
        <textarea rows="4" maxlength="200" style="border: 1px solid #ccc;border-radius: 4px;width: 100%;height: 30%"id="description" type="text" name="description" value="{{note.description}}">{{note.description}}</textarea>
        Guardar posici√≥n:
        <input type="checkbox" name="contex" value="">
        <div style="position: relative;height:25px;width:100%"></div>
        <div style="position: relative; left: 2%;top:2%" class="botones">
            <button type="submit" class="boton-enviar btn-primary">Guardar cambios</button>
            <button type="button" class="boton-cerrar btn-danger " id="cerrarModal4">Cancelar</button>
        </div>
    </form>
    </div>
</div>

<div id="notasMenu" style="position: relative;top:2%; overflow-y: scroll;height: 85%; width: 100%;">
    
      {%load static%} 
      {%for notes in apuntes%}
    <div style="float:left;height:1%;width:100%"></div>
    {%if notes.id == note.id%}
    <div style="padding: 1%;position: relative; float: left;left: 8%; width: 90%">
    <div class="elemento" style="padding: 2%;box-shadow: 1px 1px 3px rgb(100, 99, 99); z-index:1;border-radius:10px;background-color:rgba(197, 197, 197, 0.733);width: 100%">
    
    {%else%}
    <div style="padding: 1%;position: relative; float: left;left: 2%; width: 90%">
    <div class="elemento" style="padding: 2%;box-shadow: 1px 1px 3px rgb(100, 99, 99); z-index:1;border-radius:10px;background-color:rgba(255, 255, 255, 0.733);width: 100%">
    {%endif%}
    
    <div class="titulo-y-botones">
        <h4 style="width: 80%;">{{notes.name}}</h4> 
        
        <div class="botones-opciones">
            {%if notes.show%}
            <a href="/showNote/{{notes.id}}/{{notes.project.id}}" class="btn-opcion ver"><i class="material-icons">visibility</i></a>
            {%else%}
            <a href="/showNote/{{notes.id}}/{{notes.project.id}}" class="btn-opcion ver"><i class="material-icons">visibility_off</i></a>
            {%endif%}
            <a href="{{ notes.get_absolute_url }}" class="btn-opcion editar"><i class="material-icons">edit</i></a>
            <a href="/deleteNota/{{notes.id}}" class="btn-opcion borrar"><i class="material-icons">delete</i></a>
        </div>
    </div> 
    
    
        </div>
    </div>
    
    
        {%endfor%}
    </div>
    
    
</div>
<div style = "position: absolute; right: 90px;top:9%;padding: 0%;border-radius:10px; background-color:rgba(220,220,220, 0.8);width:150px">
    <button style=" width: 100%;" class="btn btn-outline-dark  btn-block js-tooltip" type="submit" onclick="location.href='{{ note.project.get_absolute_url }}'">Cancelar Edicion</button>
</div>
<!-- <button id="colorPickerBtn">Elegir color</button>
<div id="colorPickerMenu" style="display: none;">
    <input type="color" id="colorPicker" value="#3388ff">
  </div> -->
<!-- <div style="position: absolute;padding:1%; bottom:3%; right: 3%; z-index:2;padding: 1%;box-shadow: 1px 1px 10px rgb(100, 99, 99);border-radius:30px;background: rgb(255, 255, 255);width: 20%;height: 35%">
    <h3 style="font-family: Georgia;color: rgb(0, 0, 0);text-align: center;">{{notes.name}}:</h3>  
<div style="margin-left: 1%; border-radius:10px;background: rgb(238, 238, 238);padding:1%; overflow-y: scroll;position: relative;float: left; width: 98%;height: 83%">

<h4 style="font-family: Georgia;color: rgb(0, 0, 0);text-align: center;">{{notes.description}}</h4>
</div> 
<div style="width: 100%;height: 5%;"></div>

    
</div> -->

<!-- <div style="right: 2%;padding-left: 2.5% ;z-index:2; padding-top: 0.7% ;padding-right: 1% ;position: absolute;float: left;width: 20%;">   
    <button class="btn btn-outline-dark btn-block js-tooltip" onclick="location.href='{{ notes.projectSlide.get_absolute_url }}'" type="submit">Pantalla completa</button>
     
    <input id="MyButton" class="btn btn-outline-dark btn-block js-tooltip" type="button" value="Ir al cuadro" >            
    <button class="btn btn-outline-dark btn-block js-tooltip" onclick="location.href='{{ notes.projectSlide.get_absolute_url }}'" type="submit">Nueva nota</button>
    
</div>    -->
<!-- <div id="map" style="float: left;position: relative;background-color:rgb(0, 0, 0);left: 0%;top:2%;width:96%;height: 90%"></div>    -->


  
<!-- <button style="position: relative;top: 10%;left: 30%;" class="btn btn-primary js-tooltip" type="submit" onclick="location.href='{% url 'Catalogo' %}'">Retroceder</button>
 
<input id="MyButton" style="position: relative;top: 10%;left: 30%;" class="btn btn-primary js-tooltip" type="button" value="SET" onclick="onMap();">
     -->
    </div>
{% endblock %}


